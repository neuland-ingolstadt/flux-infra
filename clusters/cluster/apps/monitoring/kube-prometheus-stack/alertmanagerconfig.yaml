apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: telegram-config
  namespace: monitoring
  labels:
    alertmanagerConfig: "true"
spec:
  route:
    groupBy:
    - namespace
    - alertname
    groupWait: 30s
    groupInterval: 5m
    repeatInterval: 12h
    receiver: telegram
  receivers:
  - name: telegram
    telegramConfigs:
    - botToken:
        name: telegram-bot-secrets
        key: TELEGRAM_BOT_API_KEY
      chatID: -1003385562560
      sendResolved: true
      parseMode: Markdown
      message: |
        {{ range .Alerts }}
        ğŸ”” *Alert: {{ .Labels.alertname }}*
        {{ if .Labels.namespace }}ğŸ“¦ Namespace: `{{ .Labels.namespace }}`{{ end }}
        {{ if .Labels.severity }}âš ï¸ Severity: `{{ .Labels.severity }}`{{ end }}
        {{ if .Annotations.summary }}ğŸ“ {{ .Annotations.summary }}{{ end }}
        {{ if .Annotations.description }}{{ .Annotations.description }}{{ end }}
        {{ if .GeneratorURL }}ğŸ”— [View Details]({{ .GeneratorURL }}){{ end }}
        {{ end }}

